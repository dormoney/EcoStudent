<UserControl x:Class="eco.Views.AchievementsView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
             mc:Ignorable="d" 
             d:DesignHeight="600" d:DesignWidth="800"
             Background="{DynamicResource MaterialDesignPaper}">

    <ScrollViewer VerticalScrollBarVisibility="Auto">
        <StackPanel Margin="16">
            <TextBlock Text="Достижения" FontSize="28" FontWeight="Bold" Margin="0,0,0,16"/>
            <TextBlock Text="Отслеживайте свой прогресс и открывайте новые достижения" FontSize="16" Opacity="0.7" Margin="0,0,0,32"/>

            <!-- Фильтры -->
            <materialDesign:Card Padding="16" Margin="0,0,0,16">
                <StackPanel Orientation="Horizontal">
                    <RadioButton x:Name="AllAchievementsRadio" Content="Все достижения" 
                               GroupName="AchievementFilter" IsChecked="True"
                               Checked="FilterRadio_Checked" Margin="0,0,24,0"/>
                    <RadioButton x:Name="EarnedRadio" Content="Полученные" 
                               GroupName="AchievementFilter"
                               Checked="FilterRadio_Checked" Margin="0,0,24,0"/>
                    <RadioButton x:Name="AvailableRadio" Content="Доступные" 
                               GroupName="AchievementFilter"
                               Checked="FilterRadio_Checked"/>
                </StackPanel>
            </materialDesign:Card>

            <!-- Список достижений -->
            <ItemsControl x:Name="AchievementsItemsControl">
                <ItemsControl.ItemsPanel>
                    <ItemsPanelTemplate>
                        <WrapPanel Orientation="Horizontal"/>
                    </ItemsPanelTemplate>
                </ItemsControl.ItemsPanel>
                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <materialDesign:Card Width="280" Height="160" Margin="0,0,16,16" Padding="16">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <!-- Заголовок и статус -->
                                <Grid Grid.Row="0" Margin="0,0,0,12">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>

                                    <materialDesign:PackIcon Kind="Trophy" Width="24" Height="24" 
                                                           VerticalAlignment="Center"
                                                           Foreground="{Binding IsEarned, Converter={StaticResource BooleanToColorConverter}}"/>
                                    
                                    <TextBlock Grid.Column="1" Text="{Binding Achievement.Title}" 
                                             FontWeight="Bold" FontSize="16" 
                                             VerticalAlignment="Center" Margin="12,0,0,0"/>

                                    <materialDesign:PackIcon Grid.Column="2" Kind="CheckCircle" 
                                                           Width="20" Height="20" 
                                                           Foreground="Green"
                                                           Visibility="{Binding IsEarned, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                                </Grid>

                                <!-- Описание -->
                                <TextBlock Grid.Row="1" Text="{Binding Achievement.Description}" 
                                         TextWrapping="Wrap" Opacity="0.8" 
                                         VerticalAlignment="Top"/>

                                <!-- Прогресс -->
                                <StackPanel Grid.Row="2">
                                    <Grid Margin="0,8,0,4">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        
                                        <TextBlock Text="Требуется баллов:" Opacity="0.7"/>
                                        <TextBlock Grid.Column="1" Text="{Binding Achievement.RequiredPoints}" 
                                                 FontWeight="Bold"/>
                                    </Grid>
                                    
                                    <ProgressBar Value="{Binding Progress}" Maximum="100" 
                                               Height="6" Margin="0,4,0,0"/>
                                    
                                    <TextBlock Text="{Binding ProgressText}" FontSize="12" 
                                             Opacity="0.7" HorizontalAlignment="Center" 
                                             Margin="0,4,0,0"/>
                                </StackPanel>
                            </Grid>
                        </materialDesign:Card>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>

            <!-- Сообщение, если нет достижений -->
            <materialDesign:Card x:Name="NoAchievementsCard" Padding="32" Visibility="Collapsed">
                <StackPanel HorizontalAlignment="Center">
                    <materialDesign:PackIcon Kind="TrophyOutline" Width="64" Height="64" 
                                           HorizontalAlignment="Center" Opacity="0.5" Margin="0,0,0,16"/>
                    <TextBlock Text="Нет достижений в выбранной категории" FontSize="18" FontWeight="Bold" 
                              HorizontalAlignment="Center" Margin="0,0,0,8"/>
                    <TextBlock Text="Продолжайте сдавать вторсырье, чтобы получить новые достижения!" 
                              HorizontalAlignment="Center" Opacity="0.7"/>
                </StackPanel>
            </materialDesign:Card>
        </StackPanel>
    </ScrollViewer>
</UserControl>
